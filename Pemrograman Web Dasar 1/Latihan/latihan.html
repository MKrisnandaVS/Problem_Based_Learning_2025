<!doctype html>
<html>
  <head>
    <title>Sistem Kalibrasi Data</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h2>Sistem Data Kalibrasi</h2>
        <p>Parameter: DO; Date Range: 06/23/2002 - 10/21/2002</p>
      </div>

      <div class="stats-container">
        <div class="stat-card">
          <h4 id="totalStations">7</h4>
          <p>Total Stations</p>
        </div>
        <div class="stat-card">
          <h4 id="avgR2">0.31</h4>
          <p>Average R²</p>
        </div>
        <div class="stat-card">
          <h4 id="maxR2">0.92</h4>
          <p>Highest R²</p>
        </div>
      </div>

      <div class="card">
        <table id="calibrationTable">
          <thead>
            <tr>
              <th>Station</th>
              <th colspan="3">Simulated</th>
              <th colspan="3">Measured</th>
              <th colspan="3">Difference</th>
              <th>R²</th>
              <th>Actions</th>
            </tr>
            <tr>
              <th></th>
              <th>Mean</th>
              <th>S.Stile</th>
              <th>95%tile</th>
              <th>Mean</th>
              <th>S.Stile</th>
              <th>95%tile</th>
              <th>Mean</th>
              <th>S.Stile</th>
              <th>95%tile</th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="form-group">
        <h3>Tambah Data Baru</h3>
        <form id="calibrationForm">
          <div class="input-group">
            <input type="text" id="station" placeholder="Station" required />
            <input
              type="number"
              step="0.001"
              id="simMean"
              placeholder="Simulated Mean"
              required
            />
            <input
              type="number"
              step="0.001"
              id="measMean"
              placeholder="Measured Mean"
              required
            />
            <input
              type="number"
              step="0.001"
              id="r2"
              placeholder="R²"
              required
            />
          </div>
          <button type="submit" class="btn">
            <i class="fas fa-plus"></i> Tambah Data
          </button>
        </form>
      </div>
    </div>

    <script>
      // Data awal
      const initialData = [
        {
          station: "C11_181",
          simMean: 6.447,
          simStile: 4.686,
          sim95tile: 10.166,
          measMean: 6.992,
          measStile: 0.0,
          meas95tile: 0.0,
          diffMean: -0.545,
          diffStile: 4.686,
          diff95tile: 10.166,
          r2: 0.05,
        },
        {
          station: "C13_178",
          simMean: 7.814,
          simStile: 6.829,
          sim95tile: 10.15,
          measMean: 7.468,
          measStile: 0.0,
          meas95tile: 0.0,
          diffMean: 0.346,
          diffStile: 6.829,
          diff95tile: 10.15,
          r2: 0.0,
        },
        // Tambahkan data lainnya sesuai tabel
      ];

      function displayData(data) {
        const tbody = document.querySelector("#calibrationTable tbody");
        tbody.innerHTML = "";

        data.forEach((row, index) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
                    <td>${row.station}</td>
                    <td>${row.simMean.toFixed(3)}</td>
                    <td>${row.simStile.toFixed(3)}</td>
                    <td>${row.sim95tile.toFixed(3)}</td>
                    <td>${row.measMean.toFixed(3)}</td>
                    <td>${row.measStile.toFixed(3)}</td>
                    <td>${row.meas95tile.toFixed(3)}</td>
                    <td>${row.diffMean.toFixed(3)}</td>
                    <td>${row.diffStile.toFixed(3)}</td>
                    <td>${row.diff95tile.toFixed(3)}</td>
                    <td>${row.r2.toFixed(2)}</td>
                    <td class="actions">
                        <button class="action-btn edit-btn" onclick="editRow(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" onclick="deleteRow(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
          tbody.appendChild(tr);
        });

        updateStats(data);
      }

      function updateStats(data) {
        const totalStations = data.length;
        const avgR2 =
          data.reduce((acc, curr) => acc + curr.r2, 0) / totalStations;
        const maxR2 = Math.max(...data.map((item) => item.r2));

        document.getElementById("totalStations").textContent = totalStations;
        document.getElementById("avgR2").textContent = avgR2.toFixed(2);
        document.getElementById("maxR2").textContent = maxR2.toFixed(2);
      }

      function deleteRow(index) {
        if (confirm("Are you sure you want to delete this row?")) {
          initialData.splice(index, 1);
          displayData(initialData);
        }
      }

      function editRow(index) {
        // Implementasi fungsi edit
        alert("Edit functionality will be implemented here");
      }

      // Handle form submission
      document
        .getElementById("calibrationForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const newData = {
            station: document.getElementById("station").value,
            simMean: parseFloat(document.getElementById("simMean").value),
            simStile: 0,
            sim95tile: 0,
            measMean: parseFloat(document.getElementById("measMean").value),
            measStile: 0,
            meas95tile: 0,
            diffMean:
              parseFloat(document.getElementById("measMean").value) -
              parseFloat(document.getElementById("simMean").value),
            diffStile: 0,
            diff95tile: 0,
            r2: parseFloat(document.getElementById("r2").value),
          };

          initialData.push(newData);
          displayData(initialData);
          this.reset();
        });

      // Tampilkan data awal
      displayData(initialData);
    </script>
  </body>
</html>
